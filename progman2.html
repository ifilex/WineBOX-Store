<html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Program Manager</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;500;600&display=swap');

body, html {
    height: 100%;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
    background-color: #f3f3f3;
    overflow: hidden;
    color: #000000;
    font-size: 14px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.program-manager {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    background-image: url('https://windows11.now.sh/img/backgrounds/default.jpg');
    background-size: cover;
    background-position: center;
}

.menu-bar {
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    padding: 10px;
    display: flex;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    position: relative;
    flex-wrap: wrap;
}

.menu-item {
    padding: 8px 12px;
    cursor: pointer;
    position: relative;
    border-radius: 4px;
    transition: background-color 0.2s, color 0.2s;
    font-weight: 500;
    color: #1a1a1a;
    margin: 2px;
}

.menu-item:hover {
    background-color: rgba(255, 255, 255, 0.6);
    color: #0078d4;
}

.menu-content {
    display: none;
    position: absolute;
    background-color: #ffffff;
    min-width: 180px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1001;
    left: 0;
    top: 100%;
    border-radius: 8px;
    overflow: hidden;
}

.menu-content a {
    color: #1a1a1a;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    transition: background-color 0.2s, color 0.2s;
    font-weight: 400;
}

.menu-content a:hover {
    background-color: rgba(0, 120, 212, 0.1);
    color: #0078d4;
}

.content {
    flex-grow: 1;
    display: flex;
    flex-wrap: wrap;
    align-content: flex-start;
    padding: 20px;
    overflow-y: auto;
    position: relative;
    z-index: 1;
    justify-content: center;
}

.shortcut {
    width: 80px;
    height: 90px;
    margin: 10px;
    text-align: center;
    cursor: pointer;
    user-select: none;
    transition: transform 0.2s, background-color 0.2s;
    border-radius: 8px;
    padding: 10px;
}

.shortcut:hover {
    background-color: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
}

.shortcut img {
    width: 48px;
    height: 48px;
    margin-bottom: 5px;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
}

.shortcut-name {
    font-size: 12px;
    word-wrap: break-word;
    color: #000000;
    text-shadow: 0 1px 2px rgba(255,255,255,0.7);
    font-weight: 500;
}

.modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.4);
    backdrop-filter: blur(5px);
}

.modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 4px 20px 0 rgba(0,0,0,0.1);
    border-radius: 10px;
}

.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.2s;
}

.close:hover,
.close:focus {
    color: #000000;
}

#frame-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.8);
    display: none;
    z-index: 2000;
}

#frame-container iframe {
    width: 100%;
    height: calc(100% - 40px);
    border: none;
}

#close-frame {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: rgba(255, 255, 255, 0.8);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 24px;
    line-height: 40px;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    transition: background-color 0.2s;
}

#close-frame:hover {
    background-color: #ffffff;
}

input[type="text"], input[type="file"], select, button {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-sizing: border-box;
    font-family: 'Segoe UI', sans-serif;
    font-size: 14px;
}

button {
    background-color: #0078d4;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
    font-weight: 500;
}

button:hover {
    background-color: #106ebe;
}

h2 {
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 20px;
}

.wizard-step {
    display: none;
}

.wizard-step.active {
    display: block;
}

.wizard-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
}

.wizard-buttons button {
    width: auto;
    padding: 10px 20px;
}

.warning {
    color: #ff9800;
    font-style: italic;
    margin-top: 5px;
}

/* Store Styles */
.store-app {
    display: flex;
    background-color: white;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.store-app-image {
    width: 120px;
    height: 120px;
    object-fit: cover;
    background-color: #f5f5f5;
}

.store-app-details {
    flex: 1;
    padding: 15px;
}

.store-app-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 5px;
}

.store-app-description {
    font-size: 14px;
    color: #666;
    margin-bottom: 10px;
}

.store-app-category {
    display: inline-block;
    background-color: #e5f0fa;
    color: #0078d4;
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 12px;
    margin-bottom: 10px;
}

.store-app-button {
    background-color: #0078d4;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s;
}

.store-app-button:hover {
    background-color: #106ebe;
}

.store-app-button.installed {
    background-color: #4CAF50;
}

.store-app-button.installed:hover {
    background-color: #3e8e41;
}

.store-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.store-search {
    flex: 1;
    max-width: 300px;
}

.store-categories {
    display: flex;
    margin-bottom: 20px;
    overflow-x: auto;
    padding-bottom: 5px;
}

.store-category {
    padding: 8px 16px;
    margin-right: 10px;
    background-color: #f0f0f0;
    border-radius: 20px;
    cursor: pointer;
    transition: background-color 0.2s;
    white-space: nowrap;
}

.store-category:hover, .store-category.active {
    background-color: #0078d4;
    color: white;
}

/* Tabs */
.tabs {
    display: flex;
    border-bottom: 1px solid #ddd;
    margin-bottom: 20px;
}

.tab {
    padding: 10px 20px;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
}

.tab:hover {
    border-bottom: 2px solid #0078d4;
    color: #0078d4;
}

.tab.active {
    border-bottom: 2px solid #0078d4;
    color: #0078d4;
    font-weight: 500;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

/* Scrollbar Styles */
::-webkit-scrollbar {
    width: 10px;
}

::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
}

/* Responsive design */
@media (max-width: 768px) {
    .menu-bar {
        flex-direction: column;
        align-items: flex-start;
    }

    .menu-item {
        width: 100%;
        text-align: left;
    }

    .menu-content {
        width: 100%;
        position: static;
        box-shadow: none;
        border-radius: 0;
    }

    .content {
        justify-content: space-around;
    }

    .shortcut {
        width: 70px;
        height: 80px;
        margin: 5px;
    }

    .shortcut img {
        width: 40px;
        height: 40px;
    }

    .shortcut-name {
        font-size: 10px;
    }

    .modal-content {
        width: 95%;
        margin: 5% auto;
    }

    .store-app {
        flex-direction: column;
    }

    .store-app-image {
        width: 100%;
        height: 150px;
    }
}

@media (min-width: 769px) and (max-width: 1024px) {
    .content {
        justify-content: space-around;
    }

    .shortcut {
        width: 75px;
        height: 85px;
    }
}

@media (min-width: 1025px) {
    .content {
        justify-content: flex-start;
    }
}
</style>
</head>
<body>
<div class="program-manager">
    <div class="menu-bar">
        <div class="menu-item" onclick="toggleMenu('file-menu')">
            Archivo
            <div id="file-menu" class="menu-content">
                <a href="#" onclick="openInstallWizard()">Instalar</a>
                <a href="#" onclick="openUninstallModal()">Desinstalar</a>
                <hr>
                <a href="#" onclick="openExecuteModal()">Ejecutar...</a>
            </div>
        </div>
        <div class="menu-item" onclick="toggleMenu('help-menu')">
            Ayuda
            <div id="help-menu" class="menu-content">
                <a href="#" onclick="showHelp()">Contenido</a>
            </div>
        </div>
        <div class="menu-item" onclick="showStore()">
            Tienda
        </div>
    </div>
    
    <div class="tabs">
        <div class="tab active" onclick="switchTab('apps')">Aplicaciones</div>
        <div class="tab" onclick="switchTab('store')">Tienda</div>
    </div>
    
    <div class="content" id="shortcuts-container">
        <!-- Shortcuts will be dynamically added here -->
    </div>
    
    <div class="tab-content" id="store-content">
        <div class="store-header">
            <h2>Tienda de aplicaciones</h2>
            <input type="text" class="store-search" placeholder="Buscar aplicaciones..." oninput="filterStoreApps()">
        </div>
        
        <div class="store-categories">
            <div class="store-category active" onclick="filterByCategory('all')">Todos</div>
            <div class="store-category" onclick="filterByCategory('games')">Juegos</div>
            <div class="store-category" onclick="filterByCategory('productivity')">Productividad</div>
            <div class="store-category" onclick="filterByCategory('utilities')">Utilidades</div>
        </div>
        
        <div id="store-apps-container">
            <!-- Store apps will be dynamically added here -->
        </div>
    </div>
</div>

<div id="install-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('install-modal')">&times;</span>
        <h2>Asistente de instalación</h2>
        <div id="wizard-step-1" class="wizard-step active">
            <h3>Paso 1: Seleccionar archivo ZIP</h3>
            <input type="file" id="zip-file" accept=".zip" required>
            <div class="wizard-buttons">
                <button onclick="closeModal('install-modal')">Cancelar</button>
                <button onclick="nextStep(1)">Siguiente</button>
            </div>
        </div>
        <div id="wizard-step-2" class="wizard-step">
            <h3>Paso 2: Nombre del acceso directo</h3>
            <input type="text" id="shortcut-name" placeholder="Nombre del acceso directo" required>
            <div class="wizard-buttons">
                <button onclick="prevStep(2)">Anterior</button>
                <button onclick="nextStep(2)">Siguiente</button>
            </div>
        </div>
        <div id="wizard-step-3" class="wizard-step">
            <h3>Paso 3: Icono del acceso directo</h3>
            <input type="file" id="shortcut-icon" accept="image/*">
            <p class="warning" id="icon-warning" style="display:none;">No se ha seleccionado un icono. Se usará un icono genérico.</p>
            <div class="wizard-buttons">
                <button onclick="prevStep(3)">Anterior</button>
                <button onclick="finishInstallation()">Finalizar</button>
            </div>
        </div>
    </div>
</div>

<div id="uninstall-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('uninstall-modal')">&times;</span>
        <h2>Desinstalar aplicación</h2>
        <select id="uninstall-select">
            <!-- Options will be dynamically added here -->
        </select>
        <button onclick="uninstallShortcut()">Desinstalar</button>
    </div>
</div>

<div id="execute-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('execute-modal')">&times;</span>
        <h2>Ejecutar aplicación</h2>
        <input type="file" id="execute-file" accept=".zip">
        <button onclick="executeZip()">Ejecutar</button>
    </div>
</div>

<div id="help-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('help-modal')">&times;</span>
        <h2>Ayuda</h2>
        <p>
            Bienvenido al Administrador de Programas estilo Windows 11. Esta aplicación te permite crear accesos directos a archivos ZIP que contienen aplicaciones ejecutables y a aplicaciones de la tienda.

            Instrucciones de uso:
            1. Para instalar una nueva aplicación desde ZIP:
               - Haz clic en "Archivo" > "Instalar"
               - Sigue los pasos del asistente de instalación:
                 a) Selecciona un archivo ZIP
                 b) Asigna un nombre al acceso directo
                 c) Opcionalmente, selecciona un icono personalizado
               - Si no se proporciona un icono, se asignará uno genérico de estilo Windows 11

            2. Para instalar desde la tienda:
               - Haz clic en la pestaña "Tienda"
               - Busca la aplicación que deseas instalar
               - Haz clic en "Instalar" y la aplicación se agregará a tus accesos directos

            3. Para desinstalar una aplicación:
               - Haz clic en "Archivo" > "Desinstalar"
               - Selecciona el acceso directo que deseas eliminar
               - Las aplicaciones de la tienda aparecerán marcadas como "(Tienda)"

            4. Para ejecutar una aplicación:
               - Haz clic en el acceso directo en la pantalla principal
               - Las aplicaciones ZIP se ejecutarán en el emulador
               - Las aplicaciones de tienda se abrirán en su enlace correspondiente

            5. Para mover un acceso directo:
               - Mantén presionado el clic sobre el icono y arrástralo a la posición deseada
               - Nota: Las aplicaciones de tienda no pueden moverse

            6. Disco local:
               - El icono "Disco local" es un acceso directo permanente que te permite explorar el contenido de tu PC
               - Puedes ejecutar archivos ZIP directamente desde este explorador

            Formato de los archivos ZIP:
            - Cada archivo ZIP debe contener un archivo ejecutable con el mismo nombre que el archivo ZIP, pero con la extensión .exe
            - Por ejemplo, si el archivo ZIP se llama "miapp.zip", debe contener un archivo llamado "miapp.exe"
            - Si el archivo ZIP no contiene el ejecutable correspondiente, se mostrará un mensaje de error indicando que el archivo no es compatible

            Los accesos directos creados se guardarán automáticamente y aparecerán cada vez que abras la aplicación.
        </p>
    </div>
</div>

<div id="frame-container">
    <button id="close-frame" onclick="closeFrame()">&times;</button>
    <iframe id="app-frame" src=""></iframe>
</div>

<script>
let shortcuts = [];
let draggedShortcut = null;
let currentWizardStep = 1;
let wizardData = {};
let currentTab = 'apps';

// Estructura de datos para aplicaciones de la tienda
const storeApps = [
     {
          name: "Blood",
          image: "box/blood.jpg",
          description: "Blood is a 3D first-person shooter video game developed by Monolith Productions and published by GT Interactive.",
          category: "games",
          link: "blood.html"
        },
        {
          name: "Diablo",
          image: "box/diablo.jpg",
          description: "Diablo is an action role-playing dungeon crawler video game series developed by Blizzard North and continued by Blizzard Entertainment after the North studio shut down in 2005.",
          category: "games",
          link: "diablo.html"
        },
        {
          name: "Doom",
          image: "box/doom.jpg",
          description: "*Doom* is a first-person shooter game released in 1993, developed by id Software. Players take on the role of a space marine battling hordes of demons and hellish creatures in a Martian base. It's renowned for its fast-paced action, groundbreaking graphics for its time, and for being one of the pioneers of the FPS genre.",
          category: "games",
          link: "doom.html"
        },
        {
          name: "Doom II",
          image: "box/doom2.jpg",
          description: "*Doom* is a first-person shooter game released in 1993, developed by id Software. Players take on the role of a space marine battling hordes of demons and hellish creatures in a Martian base. It's renowned for its fast-paced action, groundbreaking graphics for its time, and for being one of the pioneers of the FPS genre.",
          category: "games",
          link: "doom2.html"
        },
        {
          name: "Duke Nukem 3D",
          image: "box/duke3d.webp",
          description: "Duke Nukem 3D is a first-person shooter video game developed by 3D Realms.",
          category: "games",
          link: "duke3d.html"
        },
        {
          name: "Dune 2000",
          image: "box/dune2000.jpg",
          description: "This is recreation of the classic strategy game Dune 2000.",
          category: "rts",
          link: "dune2000.html"
        },
        {
          name: "Dune II",
          image: "box/dune2.jpg",
          description: "This is recreation of the classic strategy game Dune 2.",
          category: "rts",
          link: "dune2.html"
        },
        {
          name: "Final DOOM",
          image: "box/finaldoom.jpg",
          description: "Final Doom is a first-person shooter video game developed by TeamTNT, and Dario and Milo Casali, and was released by id Software.",
          category: "games",
          link: "finaldoom.html"
        },
        {
          name: "Grand Theft Auto",
          image: "box/gta.jpg",
          description: "Grand Theft Auto is a famous and most played DOS game that now is available to play in browser.",
          category: "games",
          link: "gta.html"
        },
        {
          name: "Heretic",
          image: "box/heretic.jpg",
          description: "Heretic: Shadow of the Serpent Riders is a dark fantasy, spellcasting, first-person shooter developed by Raven Software and published by id Software in 1994.",
          category: "games",
          link: "heretic.html"
        },
        {
          name: "Indianapolis 500: The Simulation",
          image: "box/indi.jpg",
          description: "Indianapolis 500: The Simulation is a 1989 computer game for MS-DOS. It was hailed as the first step of differentiating racing games from the arcade realm and into racing simulation.",
          category: "rts",
          link: "indi.html"
        },
        {
          name: "Media IPTV",
          image: "box/media.png",
          description: "An IPTV media player is an application that streams live TV, video-on-demand, and online channels via IPTV protocols, offering playlist support, EPG integration, and customizable viewing options.",
          category: "multimedia",
          link: "multimedia.html"
        },
        {
          name: "Mortal Kombat",
          image: "box/mk.jpg",
          description: "Mortal Kombat is a fighting game in which players battle opponents in one-on-one matches. The player that depletes the opponent's health bar first wins",
          category: "games",
          link: "mk.html"
        },
        {
          name: "Open TTD",
          image: "box/openttd.jpg",
          description: "OpenTTD is a business simulation game in which players try to earn money by transporting passengers, minerals and goods via road, rail, water and air. It is an open-source remake and expansion of the 1995 Chris Sawyer video game Transport Tycoon Deluxe.",
          category: "rts",
          link: "openttd.html"
        },
        {
          name: "Quake",
          image: "box/quake.jpg",
          description: "Play legendary Quake game in browser without registration and ads. You can play orginal game as well as Scourge of Armagon and Dissolution of Eternity",
          category: "games",
          link: "quake.html"
        },
        {
          name: "Quarantine",
          image: "box/qua.jpg",
          description: "Quarantine is a 1994 racing/first-person shooter video game for MS-DOS and 3DO, created by Imagexcel and published by GameTek.",
          category: "games",
          link: "quarantine.html"
        },
        {
          name: "Space Quest: Chapter I - The Sarien Encounter",
          image: "box/spaceq.jpg",
          description: "Space Quest: Chapter I – The Sarien Encounter is a graphic adventure game, created by Scott Murphy and Mark Crowe.",
          category: "games",
          link: "spaceq.html"
        },
        {
          name: "Test Drive",
          image: "box/testdrive.jpg",
          description: "Test Drive is a series of racing video games that were originally published by Accolade until they were bought by Infogrames, which later turned into Atari. ",
          category: "games",
          link: "testdrive.html"
        },
        {
          name: "The Need for Speed",
          image: "box/nfs.jpg",
          description: "The Need for Speed is a 1994 racing game developed by EA Canada, originally known as Pioneer Productions, and published by Electronic Arts for 3DO. ",
          category: "games",
          link: "nfs.html"
        },
        {
          name: "Tomb Rider",
          image: "https://dos.zone/images/containers/assets/backgrounds/lhazhk.8_12f0b6d8a9.png/d44c441b8ff939af74625c8375f4c8c1.webp",
          description: "Tomb Raider, released in 1996, is a groundbreaking action-adventure game that introduced players to the iconic character Lara Croft.",
          category: "games",
          link: "tombrider.html"
        },
        {
          name: "Ultimate DOOM",
          image: "box/ultimate.jpg",
          description: "This is an updated release of the original DOOM called THE ULTIMATE DOOM. THE ULTIMATE DOOM was released in late 1993 which is months before DOOM II came out.",
          category: "games",
          link: "ultimatedoom.html"
        },
        {
          name: "Wolfenstein 3D",
          image: "box/wolf3d.jpg",
          description: "Wolfenstein 3D is a first-person shooter video game developed by id Software and published by Apogee Software and FormGen. ",
          category: "games",
          link: "wolf3d.html"
        },
        {
          name: "WolfenDOOM",
          image: "box/wolfdoom.jpg",
          description: "Wolfenstein 3D under the DOOM world. ",
          category: "games",
          link: "wolfdoom.html"
        },
        {
          name: "Wing Commander",
          image: "box/wing.jpg",
          description: "Wing Commander is a space flight simulation game, with the player piloting a ship, completing missions, and engaging enemy ships of various capabilities.",
          category: "games",
          link: "wing.html"
        },
        {
          name: "Youtube",
          image: "box/youtube.png",
          description: "YouTube is an online video platform that allows users to watch, upload, share, and stream content, including videos, live broadcasts, and playlists across various categories.",
          category: "multimedia",
          link: "http://www.youtube.com"
        },
        {
          name: "Youtube Music",
          image: "box/youtubemusic.png",
          description: "YouTube Music is a streaming service that offers music playback, personalized playlists, offline listening, and music video integration from YouTube’s extensive catalog.",
          category: "multimedia",
          link: "http://music.youtube.com"
        },
        {
          name: "Arachne Browser",
          image: "box/arachne.jpg",
          description: "Web Browser for MS-DOS.",
          category: "apps",
          link: "arachne.html"
        },
        {
          name: "AbiWord",
          image: "box/abiword.png",
          description: "Procesador de texto profesional.",
          category: "apps",
          link: "abiword.html"
        },
        {
          name: "Desktop",
          image: "box/dock.png",
          description: "The desktop is a graphical workspace in WineBOX that allows users to organize icons, access files, and launch applications. It serves as the main interface for managing windows, shortcuts, and system functions.",
          category: "apps",
          link: "dock.html"
        },
        {
          name: "DosBOX",
          image: "box/dosbox.png",
          description: "Run, test and install MS-DOS programs and game, packet in zip format.",
          category: "apps",
          link: "dosbox.html"
        },
        {
          name: "Explorer++",
          image: "box/explorer.jpg",
          description: "Gestor de archivos para Windows.",
          category: "utilities",
          link: "explorer.html"
        },
        {
          name: "7Zip",
          image: "box/7zip.jpg",
          description: "7-Zip is a file archiver with a high compression ratio. Download 7-Zip 24.08 (2024-08-11) for Windows x64 (64-bit).",
          category: "utilities",
          link: "zip.html"
        },
        {
          name: "Audacity",
          image: "box/audacity.jpg",
          description: "Audacity is the world's most popular audio editing and recording app. Edit, mix, and enhance your audio tracks with the power of Audacity.",
          category: "apps",
          link: "audacity.html"
        },
        {
          name: "Calc",
          image: "box/calc.png",
          description: "Calculator is a built-in WineBOX application that provides basic and advanced mathematical functions, including standard, scientific, programmer, and date calculations.",
          category: "utilities",
          link: "calc.html"
        },
        {
          name: "Calendar",
          image: "box/calendar.png",
          description: "Calendar is a WineBOX application that helps users manage schedules, create events, set reminders, and sync with online calendars for seamless planning.",
          category: "utilities",
          link: "calendar.html"
        },
        {
          name: "Clock",
          image: "box/clock.png",
          description: "Clock is a Windows application that provides alarms, timers, a stopwatch, and world time features to help users manage time efficiently.",
          category: "utilities",
          link: "clock.html"
        },
        {
          name: "Control",
          image: "box/control.png",
          description: "The Windows Control Panel is a tool that allows users to adjust system settings and customize hardware and software options.",
          category: "utilities",
          link: "control.html"
        },
        {
          name: "DOSShell",
          image: "box/dosshell.png",
          description: "A filemanager for MS-DOS.",
          category: "utilities",
          link: "dosshell.html"
        },
        {
          name: "Flat Assemblerl",
          image: "box/fasm.jpg",
          description: "Flat assembler is a free, multi-pass assembler with Intel-style syntax for the IA-32 and x86-64 architectures.",
          category: "apps",
          link: "fasm.html"
        },
        {
          name: "JPEGView",
          image: "box/jpegview.jpg",
          description: "JPEGView is a lean, fast and highly configurable viewer/editor for JPEG, BMP, PNG, WEBP, TGA, GIF and TIFF images with a minimal GUI.",
          category: "utilities",
          link: "jpegview.html"
        },        
       {
          name: "Media Player Classic",
          image: "box/mpc.png",
          description: "MPC-HC is an extremely light-weight, open source media player for Windows®. It supports all common video and audio file formats available for playback.",
          category: "apps",
          link: "mpc.html"
        },        
       {
          name: "Netsurf",
          image: "box/netsurf.jpg",
          description: "NetSurf is a multi-platform web browser for RISC OS, UNIX-like platforms (including Linux), Mac OS X, and more.",
          category: "apps",
          link: "netsurf.html"
        },     
       {
          name: "Notepad",
          image: "box/notepad.png",
          description: "MPC-HC is an extremely light-weight, open source media player for Windows®. It supports all common video and audio file formats available for playback.",
          category: "apps",
          link: "note.html"
        },        
       {
          name: "Notepad++",
          image: "box/npp.jpg",
          description: "Notepad++ is a free (as in “free speech” and also as in “free beer”) source code editor and Notepad replacement that supports several languages.",
          category: "apps",
          link: "npp.html"
        },       
       {
          name: "Paint",
          image: "box/paint.jpg",
          description: "Paint is a versatile and user-friendly graphics editing app in Windows for you to create, edit, and manipulate images and drawings.",
          category: "apps",
          link: "mspaint.html"
        },        
       {
          name: "Program Manager",
          image: "box/progman.png",
          description: "Program Manager is a graphical shell for managing applications and program groups in WineBOX. It allows users to organize, launch, and customize software shortcuts within a windowed interface.",
          category: "apps",
          link: "progman.html"
        },
       {
          name: "QBasic 4.5",
          image: "https://dos.zone/images/http/original/qbasic1.jpg/6a0c2580c730845b21f6f2d3b7505b50.webp",
          description: "Program Manager is a graphical shell for managing applications and program groups in WineBOX. It allows users to organize, launch, and customize software shortcuts within a windowed interface.",
          category: "apps",
          link: "qbasic.html"
        },                
       {
          name: "Open Office",
          image: "box/soffice.jpg",
          description: "The Apache OpenOffice project announces the official release of version 4.1.15. In the Release Notes you can read about all new bugfixes, improvements.",
          category: "apps",
          link: "soffice.html"
        },
       {
          name: "Shell",
          image: "box/shell.png",
          description: "Command Prompt is a WineBOX command-line interpreter that allows users to execute commands, automate tasks, and manage system functions through text-based input.",
          category: "utilities",
          link: "winefile.html"
        },   
       {
          name: "Sumatra PDF",
          image: "box/sumatra.jpg",
          description: "Sumatra PDF PDF, eBook (epub, mobi), comic book (cbz/cbr), DjVu, XPS, CHM, image viewer for Windows. Fast, small, packed with features, customizable, free.",
          category: "utilities",
          link: "sumatrapdf.html"
        },        
       {
          name: "TexWorks",
          image: "box/texworks.jpg",
          description: "A simple (La)TeX editor and PDF previewer that is available on all major desktop operating systems.",
          category: "apps",
          link: "texworks.html"
        },   
       {
          name: "ToDO",
          image: "box/todo.png",
          description: "To Do is a task management application that helps users create, organize, and track tasks with reminders, lists, and cloud synchronization.",
          category: "utilities",
          link: "todo.html"
        },   
       {
          name: "TurboC",
          image: "box/turboc.png",
          description: "Turbo C 2.01, a C compiler for MS-DOS.",
          category: "utilities",
          link: "turboc.html"
        },            
       {
          name: "TuxPaint",
          image: "box/tuxpaint.png",
          description: "Tux Paint is a free, award-winning drawing program for children ages 3 to 12 (for example, preschool and K-6).",
          category: "apps",
          link: "tuxpaint.html"
        },        
       {
          name: "UltraISO",
          image: "box/ultraiso.jpg",
          description: "Bootable CD/DVD creation is quick and simple with UltraISO - make a bootable CD or DVD and adapt it in any way you want.",
          category: "utilities",
          link: "ultraiso.html"
        },
       {
          name: "VirtualDUB",
          image: "box/virtualdub.jpg",
          description: "VirtualDub is a video capture/processing utility for 32-bit and 64-bit Windows platforms (98/ME/NT4/2000/XP/Vista/7), licensed under the GNU General Public.",
          category: "utilities",
          link: "virtualdub.html"
        },
       {
          name: "Winecfg",
          image: "box/winecfg.png",
          description: "Wine Settings for the Windows Emulation.",
          category: "utilities",
          link: "winecfg.html"
        },
       {
          name: "WineZIP",
          image: "box/winezip.png",
          description: "WineZip is an application that creates ZIP packages for installing Windows programs within WineBOX. It simplifies software deployment by packaging executable files and dependencies for seamless installation and execution.",
          category: "utilities",
          link: "winezip.html"
        },
       {
          name: "WinAMP",
          image: "box/winamp.jpg",
          description: "Winamp builds the tools that empower artists to manage their music and revenue while delivering a player that offers the perfect listening experience.",
          category: "apps",
          link: "winamp.html"
        },
       {
          name: "Wordpad",
          image: "box/wordpad.jpg",
          description: "WordPad is a word processor included with Windows 95 and later. Similarly to its predecessor Microsoft Write, it is a basic word processor.",
          category: "apps",
          link: "wordpad.html"
        },
        {
          name: "Arkanoid",
          image: "box/arkanoid.png",
          description: "Arkanoid is a block breaker video game. Its plot involves the starship Arkanoid being attacked by a mysterious entity from space named DOH. ",
          category: "arcade",
          link: "arkanoid.html"
        },
        {
          name: "Baby Type",
          image: "box/baby.jpg",
          description: "BabyType is a multi-language educational game aimed at teaching fast touch typing skills. ",
          category: "arcade",
          link: "babytype.html"
        },
        {
          name: "Baryon",
          image: "box/baryon.jpg",
          description: "Baryon is a straightforward vertical shooter which features a smooth graphical engine, a short digital sound track and various types of enemies.",
          category: "arcade",
          link: "baryon.html"
        },
        {
          name: "CD-MAN",
          image: "box/cdman.jpg",
          description: "CD-Man features 5 different worlds to pass each having nicely-drawn graphics in high-res EGA mode and therefore a new character.",
          category: "arcade",
          link: "cdman.html"
        },
        {
          name: "Dave",
          image: "box/dave.jpg",
          description: "Dangerous Dave in the Haunted Mansion is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Dangerous Dave in the Haunted Mansion on mobile.",
          category: "arcade",
          link: "dave.html"
        },
        {
          name: "Disney Aladdin",
          image: "box/aladdin.jpg",
          description: "Disney's Aladdin is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Disney's Aladdin on mobile.",
          category: "arcade",
          link: "aladdin.html"
        },
        {
          name: "Ecstatica",
          image: "https://dos.zone/images/containers/assets/backgrounds/izdxbg.%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82%2015-03-2025%20162449.jpg/f91eb9124a83f19e4987a1a77f7a69cf.webp",
          description: "Ecstatica is an action-adventure computer game released by Psygnosis in 1994 for MS-DOS.",
          category: "arcade",
          link: "ecstatica.html"
        },
        {
          name: "Earthworm Jim",
          image: "box/jim.jpg",
          description: "Earthworm Jim is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Earthworm Jim on mobile.",
          category: "arcade",
          link: "earthworm.html"
        },
        {
          name: "Golden Axe",
          image: "box/axe.jpg",
          description: "  Golden Axe is a side-scrolling, beat 'em up, hack and slash arcade video game released in 1989 by Sega for the System 16-B arcade hardware.",
          category: "arcade",
          link: "goldenaxe.html"
        },
        {
          name: "Max Mechanized Assault",
          image: "https://dos.zone/images/containers/assets/backgrounds/vvwawa.497_4a54b79a2ba3e.jpg/4d120df40fcf9efe1111c3b030510769.webp",
          description: "M.A.X.: Mechanized Assault & Exploration is a real-time strategy game set in a futuristic world. Players build bases, gather resources, and command customizable mechs to conquer opponents and explore new territories.",
          category: "rts",
          link: "max.html"
        },
        {
          name: "Out this world",
          image: "box/out.jpg",
          description: "Out of This World is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Out of This World on mobile.",
          category: "arcade",
          link: "out.html"
        },
        {
          name: "Prince of persia",
          image: "box/pre1.jpg",
          description: "Prince of Persia is a 1989 cinematic platform game developed and published by Broderbund for the Apple II. It was designed and implemented by Jordan Mechner.",
          category: "arcade",
          link: "princeofpersia.html"
        },
        {
          name: "Prince of persia 2",
          image: "box/prince2.jpg",
          description: "Prince of Persia 2: The Shadow and the Flame is a platform game released by Brøderbund in 1993.",
          category: "arcade",
          link: "princeofpersia2.html"
        },
        {
          name: "Prehistorik",
          image: "box/spaceinvaders.png",
          description: "Prehistorik is a platform game developed by Titus Interactive for the Amiga, Atari ST, Amstrad CPC and DOS.",
          category: "arcade",
          link: "prehistorik.html"
        },
        {
          name: "Prehistorik 2",
          image: "box/pre2.jpg",
          description: "Prehistorik 2 is a platform game developed by Titus Interactive for the Amiga, Atari ST, Amstrad CPC and DOS.",
          category: "arcade",
          link: "prehistorik2.html"
        },
        {
          name: "Space Invaders",
          image: "box/spaceinvaders.png",
          description: "Icónico juego arcade de disparos espaciales.",
          category: "arcade",
          link: "spaceinvaders.html"
        },
        {
          name: "The Lost Vikings",
          image: "box/vikings.jpg",
          description: "In the game, the three Vikings get kidnapped by Tomator, emperor of the alien Croutonian empire, for an inter-galactic zoo and become lost in various periods.",
          category: "arcade",
          link: "vikings.html"
        },
        {
          name: "XBill",
          image: "box/xbill.webp",
          description: "XBill is an arcade style game for the X Window System. The game features a bespectacled character known as Bill.",
          category: "arcade",
          link: "xbill.html"
        },
        {
          name: "Oregon Trail Delux",
          image: "box/oregon.jpg",
          description: "You get to play the role of a wagon leader and guide your group of chosen settlers from Independence, Missouri, to the Willamette Valley in Oregon.",
          category: "rts",
          link: "oregon.html"
        },
        {
          name: "Heroes of Might and Magic II",
          image: "box/heroes2.jpg",
          description: "The canonical ending of Heroes I results in Lord Morglin Ironfist’s victory. In the following years, he has successfully unified the continent of Enroth and secured his rule as king.",
          category: "rts",
          link: "heroes.html"
        },
        {
          name: "Heroes of Might and Magic III",
          image: "https://dos.zone/images/containers/assets/backgrounds/homm3-vcmi.jpg/6205b73e460ebc5de314ac35e1ed3abc.webp",
          description: "The canonical ending of Heroes I results in Lord Morglin Ironfist’s victory. In the following years, he has successfully unified the continent of Enroth and secured his rule as king.",
          category: "rts",
          link: "https://sec.dos.zone/vcmi/launcher/"
        },
        {
          name: "Command & Conquer",
          image: "box/command.jpg",
          description: "Wage real-time war in more ways than ever with a modern and near-future arsenal. Command the powerful US forces.",
          category: "rts",
          link: "commandconquer.html"
        },
        {
          name: "Rise of the triad",
          image: "box/rise.webp",
          description: "Rise of the Triad: Dark War is a famous and most played DOS game that now is available to play in browser. With virtual mobile controls you also can play in Rise of the Triad: Dark War on mobile. On DOS.Zone Rise of the Triad: Dark War available to play for free without registration.",
          category: "rts",
          link: "rise.html"
        },
        {
          name: "Sim City",
          image: "box/simcity.jpg",
          description: "SimCity is an open-ended city-building video game franchise originally designed by Will Wright.",
          category: "rts",
          link: "simcity.html"
        },
        {
          name: "Sim City 2000",
          image: "box/sim2000.jpg",
          description: "SimCity 2000 marked a major shift in gameplay from the original SimCity, the basic structure set forth in this seminal version has defined subsequent releases.",
          category: "rts",
          link: "simcity2000.html"
        },
        {
          name: "Warcraft",
          image: "box/war1.jpg",
          description: "Warcraft: Orcs & Humans is a real-time strategy game (RTS) developed and published by Blizzard Entertainment, and published by Interplay Productions in Europe.",
          category: "rts",
          link: "warcraft.html"
        },
        {
          name: "Warcraft II",
          image: "box/war2.jpg",
          description: "WarCraft II: Tides of Darkness is a sequel to WarCraft: Orcs & Humans strategy game for DOS.",
          category: "rts",
          link: "warcraft2.html"
        },
        {
          name: "X-COM: UFO Defense",
          image: "box/xcom.jpg",
          description: "Shooting down UFOs is just the beginning: you must then lead a squad of heavily-armed soldiers across different terrains as they investigate the UFO crash site.",
          category: "rts",
          link: "xcom.html"
        },
        {
          name: "ZED",
          image: "https://dos.zone/images/containers/assets/backgrounds/rofzsx.203_5b03ef03913fe.png/1418a024ed1903d472446d6aebc8ce6c.webp",
          description: "Z (ZED) is a real-time strategy game featuring fast-paced, action-packed gameplay. Players command robotic armies, capture territories, and engage in tactical battles across diverse landscapes to achieve victory.",
          category: "rts",
          link: "z.html"
        },
        {
          name: "Master of Orion II",
          image: "box/master.jpg",
          description: "Forge an empire in a universe where population growth is stripping away planetary resources. Colonize unknown planets and trade.",
          category: "rts",
          link: "masteroforion.html"
        }
];

// Generic Windows 11 style executable icon (SVG)
const genericExecutableIcon = `
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="48" height="48">
  <defs>
    <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#60cdff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0078d4;stop-opacity:1" />
    </linearGradient>
  </defs>
  <rect x="2" y="2" width="28" height="28" rx="6" fill="url(#grad)"/>
  <rect x="7" y="7" width="18" height="18" rx="4" fill="#ffffff"/>
  <path d="M14 11v10M18 11v10M10 15h12" stroke="#0078d4" stroke-width="2" stroke-linecap="round"/>
</svg>
`;

// Disco local icon (SVG)
const discoLocalIcon = `
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="48" height="48">
  <defs>
    <linearGradient id="diskGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffa500;stop-opacity:1" />
    </linearGradient>
  </defs>
  <rect x="2" y="2" width="28" height="28" rx="6" fill="url(#diskGrad)"/>
  <rect x="6" y="6" width="20" height="20" rx="3" fill="#ffffff"/>
  <rect x="9" y="9" width="14" height="3" rx="1" fill="#ffa500"/>
  <rect x="9" y="14" width="14" height="3" rx="1" fill="#ffa500"/>
  <rect x="9" y="19" width="14" height="3" rx="1" fill="#ffa500"/>
</svg>
`;

function toggleMenu(menuId) {
    const menu = document.getElementById(menuId);
    const isVisible = menu.style.display === 'block';
    closeAllMenus();
    if (!isVisible) {
        menu.style.display = 'block';
    }
}

function closeAllMenus() {
    const menus = document.getElementsByClassName('menu-content');
    for (let menu of menus) {
        menu.style.display = 'none';
    }
}

function openInstallWizard() {
    document.getElementById('install-modal').style.display = 'block';
    resetWizard();
    closeAllMenus();
}

function openUninstallModal() {
    document.getElementById('uninstall-modal').style.display = 'block';
    closeAllMenus();
    populateUninstallSelect();
}

function openExecuteModal() {
    document.getElementById('execute-modal').style.display = 'block';
    closeAllMenus();
}

function showHelp() {
    document.getElementById('help-modal').style.display = 'block';
    closeAllMenus();
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
    if (modalId === 'install-modal') {
        resetWizard();
    }
}

function resetWizard() {
    currentWizardStep = 1;
    wizardData = {};
    document.getElementById('zip-file').value = '';
    document.getElementById('shortcut-name').value = '';
    document.getElementById('shortcut-icon').value = '';
    document.getElementById('icon-warning').style.display = 'none';
    showWizardStep(1);
}

function showWizardStep(step) {
    document.querySelectorAll('.wizard-step').forEach(el => el.classList.remove('active'));
    document.getElementById(`wizard-step-${step}`).classList.add('active');
}

function nextStep(currentStep) {
    if (currentStep === 1) {
        const zipFile = document.getElementById('zip-file').files[0];
        if (!zipFile) {
            alert('Por favor, seleccione un archivo ZIP.');
            return;
        }
        wizardData.zipFile = zipFile;
    } else if (currentStep === 2) {
        const shortcutName = document.getElementById('shortcut-name').value.trim();
        if (!shortcutName) {
            alert('Por favor, ingrese un nombre para el acceso directo.');
            return;
        }
        wizardData.shortcutName = shortcutName;
    }

    currentWizardStep++;
    showWizardStep(currentWizardStep);

    if (currentWizardStep === 3) {
        document.getElementById('icon-warning').style.display = 'none';
    }
}

function prevStep(currentStep) {
    currentWizardStep--;
    showWizardStep(currentWizardStep);
}

function finishInstallation() {
    const shortcutIcon = document.getElementById('shortcut-icon').files[0];
    
    if (!shortcutIcon) {
        document.getElementById('icon-warning').style.display = 'block';
    }

    wizardData.shortcutIcon = shortcutIcon || 'data:image/svg+xml;base64,' + btoa(genericExecutableIcon);

    const shortcut = {
        name: wizardData.shortcutName,
        zip: wizardData.zipFile.name,
        icon: wizardData.shortcutIcon instanceof File ? URL.createObjectURL(wizardData.shortcutIcon) : wizardData.shortcutIcon,
        isStoreApp: false,
        isDiscoLocal: false
    };

    shortcuts.push(shortcut);
    saveShortcuts();
    renderShortcuts();
    renderStoreApps();
    closeModal('install-modal');
}

function populateUninstallSelect() {
    const select = document.getElementById('uninstall-select');
    select.innerHTML = '';
    
    shortcuts.forEach((shortcut, index) => {
        if (shortcut.name !== "Disco local") {
            const option = document.createElement('option');
            option.value = index;
            option.textContent = shortcut.name + (shortcut.isStoreApp ? ' (Tienda)' : '');
            select.appendChild(option);
        }
    });
}

function uninstallShortcut() {
    const select = document.getElementById('uninstall-select');
    const index = select.value;
    if (index !== '') {
        shortcuts.splice(index, 1);
        saveShortcuts();
        renderShortcuts();
        renderStoreApps();
        closeModal('uninstall-modal');
    }
}

function executeZip() {
    const zipFile = document.getElementById('execute-file').files[0];
    if (zipFile) {
        const zipName = zipFile.name.replace('.zip', '');
        openFrame(zipName);
        closeModal('execute-modal');
    }
}

function renderShortcuts() {
    const container = document.getElementById('shortcuts-container');
    container.innerHTML = '';
    
    // Add Disco local shortcut
    const discoLocalElement = createShortcutElement({
        name: "Disco local",
        icon: 'data:image/svg+xml;base64,' + btoa(discoLocalIcon),
        isDiscoLocal: true,
        isStoreApp: false
    }, -1);
    container.appendChild(discoLocalElement);

    shortcuts.forEach((shortcut, index) => {
        if (shortcut.name !== "Disco local") {
            const shortcutElement = createShortcutElement(shortcut, index);
            container.appendChild(shortcutElement);
        }
    });
}

function createShortcutElement(shortcut, index) {
    const shortcutElement = document.createElement('div');
    shortcutElement.className = 'shortcut';
    shortcutElement.draggable = !shortcut.isDiscoLocal && !shortcut.isStoreApp;
    
    // Determine icon source based on app type
    let iconContent;
    if (shortcut.isStoreApp) {
        // For store apps, use the image as icon (resized)
        iconContent = `<img src="${shortcut.icon}" alt="${shortcut.name}" width="48" height="48" style="object-fit: cover;">`;
    } else if (shortcut.isDiscoLocal) {
        // For disk local, use the SVG icon
        iconContent = `<img src="${shortcut.icon}" alt="${shortcut.name}" width="48" height="48">`;
    } else {
        // For ZIP apps, use the provided icon or generic
        iconContent = `<img src="${shortcut.icon}" alt="${shortcut.name}" width="48" height="48">`;
    }
    
    shortcutElement.innerHTML = `
        ${iconContent}
        <div class="shortcut-name">${shortcut.name}</div>
    `;
    
    if (shortcut.isDiscoLocal) {
        shortcutElement.addEventListener('click', openDiscoLocal);
    } else if (shortcut.isStoreApp) {
        // For store apps, use the link directly
        shortcutElement.addEventListener('click', () => {
            window.location.href = shortcut.link;
        });
    } else {
        // For ZIP apps, use the frame
        shortcutElement.addEventListener('click', () => openFrame(shortcut.zip.replace('.zip', '')));
    }
    
    // Only allow dragging for ZIP apps
    if (!shortcut.isDiscoLocal && !shortcut.isStoreApp) {
        shortcutElement.addEventListener('dragstart', (e) => {
            draggedShortcut = index;
            e.dataTransfer.setData('text/plain', index);
        });
        shortcutElement.addEventListener('dragover', (e) => {
            e.preventDefault();
        });
        shortcutElement.addEventListener('drop', (e) => {
            e.preventDefault();
            const dropIndex = index;
            if (draggedShortcut !== null && draggedShortcut !== dropIndex) {
                const [removed] = shortcuts.splice(draggedShortcut, 1);
                shortcuts.splice(dropIndex, 0, removed);
                saveShortcuts();
                renderShortcuts();
            }
            draggedShortcut = null;
        });
    }
    
    return shortcutElement;
}

function openDiscoLocal() {
    const frame = document.getElementById('app-frame');
    frame.src = "../../accesories/wine.html?app=files&p=winefile.exe";
    document.getElementById('frame-container').style.display = 'block';
}

function openFrame(appName) {
    const frame = document.getElementById('app-frame');
    frame.src = `../../accesories/wine.html?app=${appName}&p=${appName}.exe`;
    document.getElementById('frame-container').style.display = 'block';
}

function closeFrame() {
    document.getElementById('frame-container').style.display = 'none';
    document.getElementById('app-frame').src = '';
}

function saveShortcuts() {
    localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
}

function loadShortcuts() {
    const savedShortcuts = localStorage.getItem('shortcuts');
    if (savedShortcuts) {
        shortcuts = JSON.parse(savedShortcuts);
    }
    // Ensure Disco local is always present
    if (!shortcuts.some(shortcut => shortcut.name === "Disco local")) {
        shortcuts.unshift({
            name: "Disco local",
            icon: 'data:image/svg+xml;base64,' + btoa(discoLocalIcon),
            isDiscoLocal: true,
            isStoreApp: false
        });
    }
    renderShortcuts();
    renderStoreApps();
}

// Store functions
function renderStoreApps() {
    const container = document.getElementById('store-apps-container');
    container.innerHTML = '';
    
    storeApps.forEach(app => {
        const isInstalled = shortcuts.some(s => s.name === app.name && s.isStoreApp);
        
        const appElement = document.createElement('div');
        appElement.className = 'store-app';
        appElement.innerHTML = `
            <img src="${app.image}" class="store-app-image" alt="${app.name}">
            <div class="store-app-details">
                <div class="store-app-title">${app.name}</div>
                <div class="store-app-category">${getCategoryName(app.category)}</div>
                <div class="store-app-description">${app.description}</div>
                <button class="store-app-button ${isInstalled ? 'installed' : ''}" 
                        onclick="${isInstalled ? '' : `installStoreApp('${app.name}')`}">
                    ${isInstalled ? 'Instalado' : 'Instalar'}
                </button>
            </div>
        `;
        container.appendChild(appElement);
    });
}

function getCategoryName(category) {
    const categories = {
        'all': 'Todos',
        'games': 'Juegos',
        'productivity': 'Productividad',
        'utilities': 'Utilidades',
        'education': 'Educación'
    };
    return categories[category] || category;
}

function installStoreApp(appName) {
    const app = storeApps.find(a => a.name === appName);
    if (!app) return;
    
    const shortcut = {
        name: app.name,
        icon: app.image, // Usamos la misma imagen como ícono
        link: app.link,  // Usamos el link para abrir la aplicación
        isStoreApp: true, // Marcamos como app de tienda
        isDiscoLocal: false
    };
    
    shortcuts.push(shortcut);
    saveShortcuts();
    renderShortcuts();
    renderStoreApps();
    
    alert(`La aplicación ${app.name} se ha instalado correctamente.`);
}

function filterStoreApps() {
    const searchTerm = document.querySelector('.store-search').value.toLowerCase();
    const activeCategory = document.querySelector('.store-category.active').getAttribute('onclick').match(/'([^']+)'/)[1];
    
    const container = document.getElementById('store-apps-container');
    const apps = container.getElementsByClassName('store-app');
    
    for (let app of apps) {
        const title = app.querySelector('.store-app-title').textContent.toLowerCase();
        const category = app.querySelector('.store-app-category').textContent.toLowerCase();
        const categoryMatch = activeCategory === 'all' || getCategoryName(activeCategory).toLowerCase() === category;
        const searchMatch = title.includes(searchTerm) || 
                          app.querySelector('.store-app-description').textContent.toLowerCase().includes(searchTerm);
        
        app.style.display = (categoryMatch && searchMatch) ? 'flex' : 'none';
    }
}

function filterByCategory(category) {
    document.querySelectorAll('.store-category').forEach(el => el.classList.remove('active'));
    event.target.classList.add('active');
    filterStoreApps();
}

function switchTab(tabId) {
    currentTab = tabId;
    document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
    event.target.classList.add('active');
    
    document.getElementById('shortcuts-container').style.display = tabId === 'apps' ? 'flex' : 'none';
    document.getElementById('store-content').style.display = tabId === 'store' ? 'block' : 'none';
}

function showStore() {
    switchTab('store');
    closeAllMenus();
}

window.onclick = function(event) {
    if (!event.target.matches('.menu-item')) {
        closeAllMenus();
    }
}

window.onload = function() {
    loadShortcuts();
    switchTab('apps');
};
</script>
</body>
</html>